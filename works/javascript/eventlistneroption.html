<!DOCTYPE html> <html lang="en"><head>
<title>EventListnerOption</title>
<base href="../..">
<meta name="pathname" content="works/javascript/eventlistneroption.html">
<meta name="description" content="Documents - EventListnerOption">
<meta property="og:title" content="EventListnerOption">
<meta property="og:description" content="Documents - EventListnerOption">
<meta property="og:type" content="website">
<meta property="og:url" content="https://64etuor.github.io/works/javascript/eventlistneroption.html">
<meta property="og:image" content="undefined">
<meta name="author" content="Yangha Park"></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><meta property="og:site_name" content="Documents"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><meta charset="UTF-8"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://64etuor.github.io/site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-wasm-script" src="site-lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="site-lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:4px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#layout{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6):has(> :is(.math:not(.math-inline),table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const l=await fetch(e);if(!l.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await l.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let l=document.createRange().createContextualFragment(o),n=Array.from(l.children);for(let e of n)e?.classList?.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e?.classList?.remove("hide")}),10);t.before(l),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(l){let n=o[l],c=l+1;n?(n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(c),l<o.length&&n.addEventListener("load",(()=>e(c)))):l<o.length?e(c):t()}(0)}</script><div id="layout"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="EventListnerOption_0">EventListnerOption</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-p"><p dir="auto">last updated : 2024-07-31</p></div><div class="el-h1"><h1 data-heading="Passive event listeners" dir="auto" class="heading" id="Passive_event_listeners_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Passive event listeners</h1></div><div class="el-p"><p dir="auto">Passive event listeners are a new feature <a data-tooltip-position="top" aria-label="https://dom.spec.whatwg.org/#dom-addeventlisteneroptions-passive" rel="noopener nofollow" class="external-link is-unresolved" href="https://dom.spec.whatwg.org/#dom-addeventlisteneroptions-passive" target="_self">in the DOM spec</a> that enable developers to opt-in to better scroll performance by eliminating the need for scrolling to block on touch and wheel event listeners.  Developers can annotate touch and wheel listeners with <code>{passive: true}</code> to indicate that they will never invoke <code>preventDefault</code>.  This feature <a data-tooltip-position="top" aria-label="https://www.chromestatus.com/features/5745543795965952" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.chromestatus.com/features/5745543795965952" target="_self">shipped in Chrome 51</a>, <a data-tooltip-position="top" aria-label="https://bugzilla.mozilla.org/show_bug.cgi?id=1266066" rel="noopener nofollow" class="external-link is-unresolved" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1266066" target="_self">Firefox 49</a> and <a data-tooltip-position="top" aria-label="https://bugs.webkit.org/show_bug.cgi?id=158601" rel="noopener nofollow" class="external-link is-unresolved" href="https://bugs.webkit.org/show_bug.cgi?id=158601" target="_self">landed in WebKit</a>. Check out the video below for a side-by-side of passive event listeners in action:</p></div><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=NPM6172J22g" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.youtube.com/watch?v=NPM6172J22g" target="_self">demo video</a></p></div><div class="el-h2"><h2 data-heading="The problem" dir="auto" class="heading" id="The_problem_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>The problem</h2></div><div class="el-p"><p dir="auto">Smooth scrolling performance is essential to a good experience on the web, especially on touch-based devices.<br>
All modern browsers have a threaded scrolling feature to permit scrolling to run smoothly even when expensive<br>
JavaScript is running, but this optimization is partially defeated by the need to wait for the results of<br>
any <code>touchstart</code> and <code>touchmove</code> handlers, which may prevent the scroll entirely by calling <a data-tooltip-position="top" aria-label="http://www.w3.org/TR/touch-events/#the-touchstart-event" rel="noopener nofollow" class="external-link is-unresolved" href="http://www.w3.org/TR/touch-events/#the-touchstart-event" target="_self"><code>preventDefault()</code></a> on the event. While there are particular scenarios where an author may indeed want to prevent scrolling, analysis indicates that the majority of touch event handlers on the web never actually<br>
call <code>preventDefault()</code>, so browsers often block scrolling unnecessarily. For instance, in Chrome for Android 80% of the touch events that block scrolling never actually prevent it. 10% of these events add more than 100ms of delay to the start of scrolling, and a catastrophic delay of at least 500ms occurs in 1% of scrolls.</p></div><div class="el-p"><p dir="auto">Many developers are surprised to learn that <a data-tooltip-position="top" aria-label="http://rbyers.github.io/janky-touch-scroll.html" rel="noopener nofollow" class="external-link is-unresolved" href="http://rbyers.github.io/janky-touch-scroll.html" target="_self">simply adding an empty touch handler to their document</a> can have a<br>
significant negative impact on scroll performance.  Developers quite reasonably expect that the act of observing an event <a data-tooltip-position="top" aria-label="https://dom.spec.whatwg.org/#observing-event-listeners" rel="noopener nofollow" class="external-link is-unresolved" href="https://dom.spec.whatwg.org/#observing-event-listeners" target="_self">should not have any side-effects</a>.</p></div><div class="el-p"><p dir="auto">The fundamental problem here is not limited to touch events. <a data-tooltip-position="top" aria-label="https://w3c.github.io/uievents/#events-wheelevents" rel="noopener nofollow" class="external-link is-unresolved" href="https://w3c.github.io/uievents/#events-wheelevents" target="_self"><code>wheel</code> events</a><br>
suffer from an identical issue. In contrast, <a data-tooltip-position="top" aria-label="https://w3c.github.io/pointerevents/" rel="noopener nofollow" class="external-link is-unresolved" href="https://w3c.github.io/pointerevents/" target="_self">pointer event handlers</a> are<br>
designed to never delay scrolling (though developers can declaratively suppress scrolling altogether with the <code>touch-action</code> CSS property), so do not suffer from this issue. Essentially the passive event listener proposal brings the performance properties of pointer events to touch and wheel events.</p></div><div class="el-p"><p dir="auto">This proposal provides a way for authors to indicate at handler registration time whether the handler may call <code>preventDefault()</code> on the event (i.e. whether it needs an event that is <a data-tooltip-position="top" aria-label="https://dom.spec.whatwg.org/#dom-event-cancelable" rel="noopener nofollow" class="external-link is-unresolved" href="https://dom.spec.whatwg.org/#dom-event-cancelable" target="_self">cancelable</a>). When no touch or wheel handlers at a particular point require a cancelable event, a user agent is free to start scrolling immediately without waiting for JavaScript.  That is, passive listeners are free from surprising performance side-effects.</p></div><div class="el-h2"><h2 data-heading="EventListenerOptions" dir="auto" class="heading" id="EventListenerOptions_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>EventListenerOptions</h2></div><div class="el-p"><p dir="auto">First, we need a mechanism for attaching additional information to an event listener.  Today the <code>capture</code> argument to <code>addEventListener</code> is the closest example of something like this, but its usage is pretty opaque:</p></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded">  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://dom.spec.whatwg.org/#dictdef-eventlisteneroptions" rel="noopener nofollow" class="external-link is-unresolved" href="https://dom.spec.whatwg.org/#dictdef-eventlisteneroptions" target="_self"><code>EventListenerOptions</code></a> lets us write this more explicitly as:</p></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded">  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">capture</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">This is simply the new (extensible) syntax for existing behavior - specifying <a data-tooltip-position="top" aria-label="http://javascript.info/tutorial/bubbling-and-capturing#capturing" rel="noopener nofollow" class="external-link is-unresolved" href="http://javascript.info/tutorial/bubbling-and-capturing#capturing" target="_self">whether you want the listener invoked during the capture phase or bubbling phase</a>.</p></div><div class="el-h2"><h2 data-heading="Solution: the 'passive' option" dir="auto" class="heading" id="Solution_the_'passive'_option_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Solution: the 'passive' option</h2></div><div class="el-p"><p dir="auto">Now that we have an extensible syntax for specifying options at event handler registration time, we can add a new <code>passive</code> option which declares up-front that the listener will never call <code>preventDefault()</code> on the event.  If it does, the user agent will just ignore the request (ideally generating at least a console warning), as it already does for events with <code>Event.cancelable=false</code>.  A developer can verify this by querying <code>Event.defaultPrevented</code> before and after calling <code>preventDefault()</code>.  Eg:</p></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded">  <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">,</span> <span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">defaultPrevented</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// will be false</span>
    e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// does nothing since the listener is passive</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token property-access">defaultPrevented</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// still false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Modernizr</span><span class="token punctuation">.</span><span class="token property-access">passiveeventlisteners</span> <span class="token operator">?</span> <span class="token punctuation">{</span><span class="token literal-property property">passive</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Now rather than having to block scrolling whenever there are any touch or wheel listener, the browser only needs to do this when there are <em>non-passive</em> listeners (see <a data-tooltip-position="top" aria-label="http://w3c.github.io/touch-events/#cancelability" rel="noopener nofollow" class="external-link is-unresolved" href="http://w3c.github.io/touch-events/#cancelability" target="_self">TouchEvents spec</a>).  <code>passive</code> listeners are free of performance side-effects.</p></div><div class="el-p"><p dir="auto"><strong>By marking a touch or wheel listener as <code>passive</code>, the developer is promising the handler won't call <code>preventDefault</code> to disable scrolling.</strong>  This frees the browser up to respond to scrolling immediately without waiting for JavaScript, thus ensuring a reliably smooth scrolling experience for the user.</p></div><div class="el-h2"><h2 data-heading="Feature Detection" dir="auto" class="heading" id="Feature_Detection_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Feature Detection</h2></div><div class="el-p"><p dir="auto">Because older browsers will interpret any object in the 3rd argument as a <code>true</code> value for the <code>capture</code> argument, it's important for developers to use feature detection or <a data-tooltip-position="top" aria-label="https://github.com/WebReflection/dom4" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/WebReflection/dom4" target="_self">a polyfill</a> when using this API, to avoid unforeseen results.  Feature detection for specific options can be done as follows:</p></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// Test via a getter in the options object to see if the passive property is accessed</span>
<span class="token keyword">var</span> supportsPassive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> opts <span class="token operator">=</span> <span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'passive'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      supportsPassive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"testPassive"</span><span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"testPassive"</span><span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">,</span> opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Use our detect's results. passive applied if supported, capture will be false either way.</span>
elem<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span> supportsPassive <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token literal-property property">passive</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">To make this simpler you can use the feature detect from <a data-tooltip-position="top" aria-label="https://github.com/rafrex/detect-it" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/rafrex/detect-it" target="_self">Detect It</a>, eg:</p></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded">  elem<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> fn<span class="token punctuation">,</span>
    detectIt<span class="token punctuation">.</span><span class="token property-access">passiveEvents</span> <span class="token operator">?</span> <span class="token punctuation">{</span><span class="token literal-property property">passive</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://modernizr.com/" rel="noopener nofollow" class="external-link is-unresolved" href="https://modernizr.com/" target="_self">Modernizr</a> also has a detect <a data-tooltip-position="top" aria-label="https://github.com/Modernizr/Modernizr/pull/1982" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/Modernizr/Modernizr/pull/1982" target="_self">here</a>.  There is an <a data-tooltip-position="top" aria-label="https://github.com/heycam/webidl/issues/107" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/heycam/webidl/issues/107" target="_self">open standards debate</a> around providing a simpler API for dictionary member feature detection.</p></div><div class="el-h2"><h2 data-heading="Removing the need to cancel events" dir="auto" class="heading" id="Removing_the_need_to_cancel_events_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Removing the need to cancel events</h2></div><div class="el-p"><p dir="auto">There are scenarios where an author may intentionally want to consistently disable scrolling by cancelling all touch or wheel events. These include:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Panning and zooming a map</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Full-page/full-screen games</li>
</ul></div><div class="el-p"><p dir="auto">In these cases, the current behavior (which prevents scrolling optimization) is perfectly adequate, since scrolling itself is being prevented consistently.  There is no need to use passive listeners in these cases, though it's often still a good idea to apply a <code>touch-action: none</code> CSS rule to make your intention explicit (eg. supporting browsers with Pointer Events but not Touch Events).</p></div><div class="el-p"><p dir="auto"> However, in a number of common scenarios events don't need to block scrolling - for instance:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>User activity monitoring which just wants to know when the user was last active</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><code>touchstart</code> handlers that hide some active UI (like tooltips)</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><code>touchstart</code> and <code>touchend</code> handlers that style UI elements (without suppressing the <code>click</code> event).</li>
</ul></div><div class="el-p"><p dir="auto">For these scenarios, the <code>passive</code> option can be added (with appropriate feature detection) without any other code changes, resulting in a significantly smoother scrolling experience.</p></div><div class="el-p"><p dir="auto">There are a few more complicated scenarios where the handler only wants to suppress scrolling under certain conditions, such as:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Swiping horizontally to rotate a carousel, dismiss an item or reveal a drawer, while still permitting vertical scrolling.
<ul class="has-list-bullet">
<li data-line="1" dir="auto"><span class="list-bullet"></span>In this case, use <a data-tooltip-position="top" aria-label="https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action" rel="noopener nofollow" class="external-link is-unresolved" href="https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action" target="_self">touch-action: pan-y</a> to declaratively disable scrolling that starts along the horizontal axis without having to call <code>preventDefault()</code> (<a data-tooltip-position="top" aria-label="https://rbyers.github.io/touch-action.html" rel="noopener nofollow" class="external-link is-unresolved" href="https://rbyers.github.io/touch-action.html" target="_self">test page</a>).</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>To continue to work correctly in all browsers, calls to <code>preventDefault</code> should be conditional on the lack of support for the particular <code>touch-action</code> rule being used (note that Safari 9 currently only supports <code>touch-action: manipulation</code>).</li>
</ul>
</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span>A UI element (like YouTube's volume slider) which slides on horizontal wheel events without changing the scrolling behavior on vertical wheel events. Since there is no equivalent of "touch-action" for wheel events, this case can only be implemented with non-passive wheel listeners.</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Event delegation patterns where the code that adds the listener won't know if the consumer will cancel the event.
<ul class="has-list-bullet">
<li data-line="5" dir="auto"><span class="list-bullet"></span>One option here is to do delegation separately for passive and non-passive listeners (as if they were different event types entirely).</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span>It's also possible to leverage <code>touch-action</code> as above (treating Touch Events as you would <a data-tooltip-position="top" aria-label="https://w3c.github.io/pointerevents/" rel="noopener nofollow" class="external-link is-unresolved" href="https://w3c.github.io/pointerevents/" target="_self">Pointer Events</a>.</li>
</ul>
</li>
</ul></div><div class="el-h2"><h2 data-heading="Debugging and measuring the benefit" dir="auto" class="heading" id="Debugging_and_measuring_the_benefit_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Debugging and measuring the benefit</h2></div><div class="el-p"><p dir="auto">You can get a quick idea of the benefit possible (and potential breakage) by forcing touch/wheel listeners to be treated as passive via  chrome://flags/#passive-listener-default (new in Chrome 52).  This makes it easy to do your own side-by-side comparisons like <a data-tooltip-position="top" aria-label="https://twitter.com/RickByers/status/719736672523407360" rel="noopener nofollow" class="external-link is-unresolved" href="https://twitter.com/RickByers/status/719736672523407360" target="_self">this popular video</a>.</p></div><div class="el-p"><p dir="auto">See <a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=6-D_3yx_KVI" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.youtube.com/watch?v=6-D_3yx_KVI" target="_self">this video</a> for tips on how to use Chrome's Developer Tools to identify listeners that are blocking scrolling.  You can <a data-tooltip-position="top" aria-label="http://rbyers.net/scroll-latency.html" rel="noopener nofollow" class="external-link is-unresolved" href="http://rbyers.net/scroll-latency.html" target="_self">monitor event timestamps</a> to measure scroll jank in the wild, and use <a data-tooltip-position="top" aria-label="https://www.chromium.org/developers/how-tos/trace-event-profiling-tool" rel="noopener nofollow" class="external-link is-unresolved" href="https://www.chromium.org/developers/how-tos/trace-event-profiling-tool" target="_self">Chromium's tracing system</a> to look at the InputLatency records for scrolling when debugging.</p></div><div class="el-p"><p dir="auto">The Chrome team is working on a proposal for both a <a data-tooltip-position="top" aria-label="https://code.google.com/p/chromium/issues/detail?id=543598" rel="noopener nofollow" class="external-link is-unresolved" href="https://code.google.com/p/chromium/issues/detail?id=543598" target="_self">PerformanceTimeline API</a> and more <a data-tooltip-position="top" aria-label="https://code.google.com/p/chromium/issues/detail?id=520659" rel="noopener nofollow" class="external-link is-unresolved" href="https://code.google.com/p/chromium/issues/detail?id=520659" target="_self">DevTools features</a> to help web developers get better visibility into this problem today.  </p></div><div class="el-h2"><h2 data-heading="Reducing and breaking up long-running JS is still critical" dir="auto" class="heading" id="Reducing_and_breaking_up_long-running_JS_is_still_critical_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Reducing and breaking up long-running JS is still critical</h2></div><div class="el-p"><p dir="auto">When a page exhibits substantial scroll jank, it's always an indication of an underlying peformance issue somewhere.  Passive event listeners do nothing to address these underlying issues, so we still strongly encourage developers to ensure that their application meets the <a data-tooltip-position="top" aria-label="https://developers.google.com/web/tools/chrome-devtools/profile/evaluate-performance/rail?hl=en" rel="noopener nofollow" class="external-link is-unresolved" href="https://developers.google.com/web/tools/chrome-devtools/profile/evaluate-performance/rail?hl=en" target="_self">RAIL guidelines</a> even on low-end devices.  If your site has logic that runs for &gt;100ms at a time, it will still feel sluggish in response to taps / clicks.  Passive event listeners just allow developers to decouple the issue of having JS responsiveness reflected in scroll performance from the desire to monitor input events.  In particular, developers of third-party analytics libraries can now have some confidence that their use of light-weight event listeners will not fundamentally change the observed performance characteristics of any page using their code.</p></div><div class="el-h2"><h2 data-heading="Further reading and discussion" dir="auto" class="heading" id="Further_reading_and_discussion_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Further reading and discussion</h2></div><div class="el-p"><p dir="auto">See the links <a data-tooltip-position="top" aria-label="https://github.com/WICG/EventListenerOptions" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/WICG/EventListenerOptions" target="_self">here</a> for more details.  For questions or concerns, feel free to <a data-tooltip-position="top" aria-label="https://github.com/WICG/EventListenerOptions/issues" rel="noopener nofollow" class="external-link is-unresolved" href="https://github.com/WICG/EventListenerOptions/issues" target="_self">file issues on this repo</a>, or reach out to <a data-tooltip-position="top" aria-label="https://twitter.com/RickByers/" rel="noopener nofollow" class="external-link is-unresolved" href="https://twitter.com/RickByers/" target="_self">@RickByers</a>.</p></div><div class="el-h2"><h2 data-heading="EventLinsterOptions Javascript" dir="auto" class="heading" id="EventLinsterOptions_Javascript_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>EventLinsterOptions Javascript</h2></div><div class="el-pre"><pre class="language-javascript" tabindex="0"><code data-line="0" class="language-javascript is-loaded"><span class="token comment">// EventListenerOptions.polyfill.js</span>
<span class="token comment">// ==ClosureCompiler==</span>
<span class="token comment">// @compilation_level SIMPLE_OPTIMIZATIONS</span>
<span class="token comment">// @output_file_name EventListenerOptions.shim.min.js</span>
<span class="token comment">// @language ECMASCRIPT5</span>
<span class="token comment">// ==/ClosureCompiler==</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> supportsPassive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span> <span class="token function">passive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      supportsPassive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>supportsPassive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> super_add_event_listener <span class="token operator">=</span> <span class="token class-name">EventTarget</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token property-access">addEventListener</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> super_remove_event_listener <span class="token operator">=</span> <span class="token class-name">EventTarget</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token property-access">removeEventListener</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> super_prevent_default <span class="token operator">=</span> <span class="token class-name">Event</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token property-access">preventDefault</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">parseOptions</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> needsWrapping <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> useCapture <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> passive <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> fieldId<span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          passive <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token property-access">passive</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
          useCapture <span class="token operator">=</span> options<span class="token punctuation">.</span><span class="token property-access">useCapture</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
          useCapture <span class="token operator">=</span> options<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>passive<span class="token punctuation">)</span>
        needsWrapping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>needsWrapping<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fieldId <span class="token operator">=</span> useCapture<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fieldId <span class="token operator">+=</span> passive<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">action</span><span class="token punctuation">(</span>needsWrapping<span class="token punctuation">,</span> fieldId<span class="token punctuation">,</span> useCapture<span class="token punctuation">,</span> passive<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Event</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">preventDefault</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__passive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">warn</span><span class="token punctuation">(</span><span class="token string">"Ignored attempt to preventDefault an event from a passive listener"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      super_prevent_default<span class="token punctuation">.</span><span class="token method function property-access">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">EventTarget</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">addEventListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> super_this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token function">parseOptions</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">,</span>
        <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">needsWrapping<span class="token punctuation">,</span> fieldId<span class="token punctuation">,</span> useCapture<span class="token punctuation">,</span> passive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>needsWrapping<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> fieldId <span class="token operator">=</span> useCapture<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fieldId <span class="token operator">+=</span> passive<span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">)</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">[</span>fieldId<span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> wrapped <span class="token operator">=</span> <span class="token punctuation">{</span>
              <span class="token function-variable function">handleEvent</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token property-access">__passive</span> <span class="token operator">=</span> passive<span class="token punctuation">;</span>
                <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                  <span class="token function">listener</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
                  listener<span class="token punctuation">.</span><span class="token method function property-access">handleEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                e<span class="token punctuation">.</span><span class="token property-access">__passive</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">[</span>fieldId<span class="token punctuation">]</span> <span class="token operator">=</span> wrapped<span class="token punctuation">;</span>
            super_add_event_listener<span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>super_this<span class="token punctuation">,</span> type<span class="token punctuation">,</span> wrapped<span class="token punctuation">,</span> useCapture<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            super_add_event_listener<span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>super_this<span class="token punctuation">,</span> type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> useCapture<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">EventTarget</span><span class="token punctuation">.</span><span class="token property-access">prototype</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">removeEventListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> super_this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token function">parseOptions</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> options<span class="token punctuation">,</span>
        <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">needsWrapping<span class="token punctuation">,</span> fieldId<span class="token punctuation">,</span> useCapture<span class="token punctuation">,</span> passive</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>needsWrapping <span class="token operator">&amp;&amp;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span> <span class="token operator">&amp;&amp;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">[</span>fieldId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            super_remove_event_listener<span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>super_this<span class="token punctuation">,</span> type<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">[</span>fieldId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">[</span>fieldId<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
              <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">__event_listeners_options</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">[</span>listener<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            super_remove_event_listener<span class="token punctuation">.</span><span class="token method function property-access">call</span><span class="token punctuation">(</span>super_this<span class="token punctuation">,</span> type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> useCapture<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div class="graph-view-wrapper"><div class="feature-header"><div class="feature-title">Interactive Graph</div></div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<div class="graph-icon graph-global" role="button" aria-label="Global Graph" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-git-fork"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#EventListnerOption_0" data-path="#EventListnerOption_0"><div class="tree-item-inner heading-link" heading-name="EventListnerOption">EventListnerOption</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="works/javascript/eventlistneroption.html#Passive_event_listeners_0" data-path="#Passive_event_listeners_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Passive event listeners">Passive event listeners</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#The_problem_0" data-path="#The_problem_0"><div class="tree-item-inner heading-link" heading-name="The problem">The problem</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#EventListenerOptions_0" data-path="#EventListenerOptions_0"><div class="tree-item-inner heading-link" heading-name="EventListenerOptions">EventListenerOptions</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Solution_the_'passive'_option_0" data-path="#Solution_the_'passive'_option_0"><div class="tree-item-inner heading-link" heading-name="Solution: the 'passive' option">Solution: the 'passive' option</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Feature_Detection_0" data-path="#Feature_Detection_0"><div class="tree-item-inner heading-link" heading-name="Feature Detection">Feature Detection</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Removing_the_need_to_cancel_events_0" data-path="#Removing_the_need_to_cancel_events_0"><div class="tree-item-inner heading-link" heading-name="Removing the need to cancel events">Removing the need to cancel events</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Debugging_and_measuring_the_benefit_0" data-path="#Debugging_and_measuring_the_benefit_0"><div class="tree-item-inner heading-link" heading-name="Debugging and measuring the benefit">Debugging and measuring the benefit</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Reducing_and_breaking_up_long-running_JS_is_still_critical_0" data-path="#Reducing_and_breaking_up_long-running_JS_is_still_critical_0"><div class="tree-item-inner heading-link" heading-name="Reducing and breaking up long-running JS is still critical">Reducing and breaking up long-running JS is still critical</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#Further_reading_and_discussion_0" data-path="#Further_reading_and_discussion_0"><div class="tree-item-inner heading-link" heading-name="Further reading and discussion">Further reading and discussion</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/javascript/eventlistneroption.html#EventLinsterOptions_Javascript_0" data-path="#EventLinsterOptions_Javascript_0"><div class="tree-item-inner heading-link" heading-name="EventLinsterOptions Javascript">EventLinsterOptions Javascript</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></body></html>