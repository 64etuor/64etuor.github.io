<!DOCTYPE html> <html lang="en"><head>
<title>Excel VBA_E-BOM to M-BOM 자동 변환 모듈</title>
<base href="../../..">
<meta name="pathname" content="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html">
<meta name="description" content="Documents - Excel VBA_E-BOM to M-BOM 자동 변환 모듈">
<meta property="og:title" content="Excel VBA_E-BOM to M-BOM 자동 변환 모듈">
<meta property="og:description" content="Documents - Excel VBA_E-BOM to M-BOM 자동 변환 모듈">
<meta property="og:type" content="website">
<meta property="og:url" content="https://64etuor.github.io/works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html">
<meta property="og:image" content="undefined">
<meta name="author" content="Yangha Park"></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><meta property="og:site_name" content="Documents"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><meta charset="UTF-8"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://64etuor.github.io/site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-wasm-script" src="site-lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="site-lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:4px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#layout{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6):has(> :is(.math:not(.math-inline),table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const l=await fetch(e);if(!l.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await l.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let l=document.createRange().createContextualFragment(o),n=Array.from(l.children);for(let e of n)e?.classList?.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e?.classList?.remove("hide")}),10);t.before(l),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(l){let n=o[l],c=l+1;n?(n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(c),l<o.length&&n.addEventListener("load",(()=>e(c)))):l<o.length?e(c):t()}(0)}</script><div id="layout"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Excel_VBA_E-BOM_to_M-BOM_자동_변환_모듈_0">Excel VBA_E-BOM to M-BOM 자동 변환 모듈</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h2"><h2 data-heading="배경:" dir="auto" class="heading" id="배경_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>배경:</h2></div><div class="el-p"><p dir="auto">입사를 한 지 얼마 안되는 시기였을 때다. 우리 부서의 담당자가 Agile에 등록된 E-BOM을 기반으로 M-BOM을 만드는 업무를 수년간 하고 있었다. 그런데 이 작업을 수작업으로 하고 있다 보니 시간도 엄청나게 오래 걸릴 뿐더러, 실수가 발생할 가능성도 보였다. 따라서 그런 문제점들을 없애고자 E-BOM to M-BOM 자동 변환 모듈 개발을 시작했다.</p></div><div class="el-h2"><h2 data-heading="필요 기능 정리" dir="auto" class="heading" id="필요_기능_정리_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>필요 기능 정리</h2></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Agile E-BoM Level 열 앞에 11개 열을 만들고 각 열의 이름을 0~10까지의 순서대로 나열, 그리고 Level의 숫자를 매칭되는 열에 입력.</li>
<li data-line="1" dir="auto">M-BoM에서 사용하지 않는 열 삭제 및 필요한 열의 순서 정렬</li>
<li data-line="2" dir="auto">특정 위치에 BLANK 열 추가</li>
<li data-line="3" dir="auto">M-BOM.QTY 열 추가: E-BOM은 생산단위별 소요량이 나오지만 M-BOM은 제품을 만드는데 필요한 총 소요량이 필요함. 상위 Level 부품의 개수에 맞추어 하위 Level 소요량 재조정.(예를 들어 상위 Level 부품의 개수가 3이면 하위 Level 소요량에 3을 곱한 수량을 산출하여 입력, Level이 그보다 낮은 부품이 있다면 상위 Level의 소요량을 연속해서 곱해줌.)</li>
<li data-line="4" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>M-BOM.E/EP/SC 열 추가: Level 계층 구조에 따라 부품의 구매/도급/직접생산 여부를 결정.
<ul class="has-list-bullet">
<li data-line="5" dir="auto"><span class="list-bullet"></span>Buy/Make 열 값이 <code>Buy</code>인&nbsp;항목을 열 위에서 아래 방향으로 찾고&nbsp;현재 레벨이 부모 레벨과 같거나 낮으면 <code>M-BOM.E/EP/SC</code>&nbsp;열에&nbsp;<code>E</code>&nbsp;값을 할당. 그리고 부모 레벨을 현재 레벨로 업데이트.</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span>부모 레벨의 Buy/Make 열 값이 <code>Make</code>&nbsp;이고&nbsp;현재 행의 레벨이 부모 레벨과 같거나 낮을 때 부모 레벨을&nbsp;<strong>현재 레벨 + 1</strong>로 설정.</li>
<li data-line="7" dir="auto"><span class="list-bullet"></span>현재 행의 레벨이 부모 레벨보다 높으면서&nbsp;<code>Buy</code>&nbsp;항목이면, <code>M-BOM.E/EP/SC</code>&nbsp;열에&nbsp;<code>EP</code>&nbsp;값을 할당.</li>
</ul>
</li>
<li data-line="8" dir="auto">열 너비 조정</li>
</ol></div><div class="el-h2"><h2 data-heading="Code:" dir="auto" class="heading" id="Code_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Code:</h2></div><div class="el-p"><p dir="auto">추후에 내가 아니어도 코드를 수정하기 쉽게 각 기능을 Private Sub 함수로 쪼개준다.<br>
그 후에 실행 함수에서 Private Sub 함수들을 활용하여 직관적이고 유저에게 친화적인 코드로 작성한다.</p></div><div class="el-h3"><h3 data-heading="1. 열 삽입 및 헤더 초기화" dir="auto" class="heading" id="1._열_삽입_및_헤더_초기화_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. 열 삽입 및 헤더 초기화</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 열 삽입 및 헤더 초기화</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> InsertHeadersAndInitialize<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> columnCount <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> columnCount
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="2. 0~10까지의 Level 값 헤더와 매칭하여 채우기" dir="auto" class="heading" id="2._0~10까지의_Level_값_헤더와_매칭하여_채우기_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. 0~10까지의 Level 값 헤더와 매칭하여 채우기</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 0부터 10까지 Level 값 채우기</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> FillLevels<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> maxCol <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Variant</span>  <span class="token comment">' 각 행의 Level 값</span>
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token comment">' L 열의 마지막 행 찾기</span>
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row

    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> maxCol
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span> i
    
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value  <span class="token comment">' L 열의 Level 값 읽기</span>

        <span class="token comment">' 유효한 Level 값(0 ~ maxCol-1)만 처리</span>
        <span class="token keyword">If</span> IsNumeric<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span> maxCol <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> currentLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> currentLevel  <span class="token comment">' 해당 Level에 맞는 열에 값 입력</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="3. 열 삽입 및 복사 함수" dir="auto" class="heading" id="3._열_삽입_및_복사_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>3. 열 삽입 및 복사 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 열 삽입 및 복사 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> HandleColumnCopy<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> columnName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> targetCol <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> width <span class="token keyword">As</span> <span class="token keyword">Integer</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> find <span class="token keyword">As</span> Range
    <span class="token keyword">Set</span> find <span class="token operator">=</span> ws<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlValues<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlWhole<span class="token punctuation">)</span>

    <span class="token keyword">If</span> <span class="token keyword">Not</span> find <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
        find<span class="token punctuation">.</span>EntireColumn<span class="token punctuation">.</span>Cut destination<span class="token punctuation">:</span><span class="token operator">=</span>ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span>
        Application<span class="token punctuation">.</span>CutCopyMode <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">If</span> width <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span> ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> width
    <span class="token keyword">Else</span>
        MsgBox <span class="token string">"Column '"</span> <span class="token operator">&amp;</span> columnName <span class="token operator">&amp;</span> <span class="token string">"' not found!"</span><span class="token punctuation">,</span> vbExclamation<span class="token punctuation">,</span> <span class="token string">"Error"</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="4. 새로운 열 추가 함수" dir="auto" class="heading" id="4._새로운_열_추가_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>4. 새로운 열 추가 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 새로운 열 추가 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> AddNewColumn<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> colNum <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> header <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> value <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">)</span>

    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> header
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> r <span class="token keyword">As</span> <span class="token keyword">Long</span>
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> colNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
    <span class="token keyword">Next</span> r
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="5. 빈 열 삽입 함수" dir="auto" class="heading" id="5._빈_열_삽입_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>5. 빈 열 삽입 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 빈 열 삽입 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> InsertEmptyColumns<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> startCol <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> count <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> count
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>startCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="6. 열 너비 조정 함수" dir="auto" class="heading" id="6._열_너비_조정_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>6. 열 너비 조정 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' 열 너비 조정 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> AdjustColumnWidths<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span>

    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"A:K"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">3</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"M:N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">20</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"U:V"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">25</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"X:Y"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">25</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="7. E/EP/SC 처리 함수" dir="auto" class="heading" id="7._E/EP/SC_처리_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>7. E/EP/SC 처리 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' E/EP/SC 처리 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> MBOM_DIV_FILL<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> parentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> parentRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>ActiveSheet
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row

    parentRow <span class="token operator">=</span> FindParentRow<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"Buy"</span><span class="token punctuation">,</span> parentLevel<span class="token punctuation">)</span>

    <span class="token keyword">If</span> parentRow <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        MsgBox <span class="token string">"""BOM.Buy"" row not found in the specified column."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    <span class="token keyword">For</span> i <span class="token operator">=</span> parentRow <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        <span class="token keyword">If</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Buy"</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span><span class="token operator">=</span> parentLevel <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"E"</span>
            parentLevel <span class="token operator">=</span> currentLevel
        <span class="token keyword">ElseIf</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Make"</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span><span class="token operator">=</span> parentLevel <span class="token keyword">Then</span>
            parentLevel <span class="token operator">=</span> currentLevel <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">ElseIf</span> currentLevel <span class="token operator">&gt;</span> parentLevel <span class="token keyword">And</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Buy"</span> <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"EP"</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' Parent Row 찾기</span>
<span class="token keyword">Function</span> FindParentRow<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> colName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> searchValue <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> parentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> colName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
        <span class="token keyword">If</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> colName<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> searchValue <span class="token keyword">Then</span>
            parentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
            FindParentRow <span class="token operator">=</span> i
            <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i
    FindParentRow <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="8. M-BOM Qty 계산 함수" dir="auto" class="heading" id="8._M-BOM_Qty_계산_함수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>8. M-BOM Qty 계산 함수</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token comment">' MBOM QTY 계산 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> MBOM_QTY_CAL<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> levels<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>  <span class="token comment">' 각 레벨별 누적 수량 저장</span>
    <span class="token keyword">Dim</span> maxLevel <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> currentQty <span class="token keyword">As</span> <span class="token keyword">Variant</span>

    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>ActiveSheet
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    maxLevel <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment">' 최대 레벨 설정</span>

    <span class="token comment">' 1부터 시작하는 배열 초기화</span>
    <span class="token keyword">ReDim</span> levels<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> maxLevel<span class="token punctuation">)</span>

    <span class="token comment">' 각 행에 대해 수량 계산 수행</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        currentQty <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"O"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value

        <span class="token comment">' 빈 셀, 숫자가 아닌 값, 레벨이 초과된 경우 건너뛰기</span>
        <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">Or</span> IsEmpty<span class="token punctuation">(</span>currentQty<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">If</span> <span class="token keyword">Not</span> IsNumeric<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">Or</span> <span class="token keyword">Not</span> IsNumeric<span class="token punctuation">(</span>currentQty<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">If</span> currentLevel <span class="token operator">&gt;</span> maxLevel <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"P"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ClearContents  <span class="token comment">' 레벨이 초과되면 P 열을 비움</span>
            <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">End</span> <span class="token keyword">If</span>

        <span class="token comment">' 누적 수량 계산: 현재 레벨의 수량에 상위 모든 부모 수량을 곱함</span>
        <span class="token keyword">If</span> currentLevel <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
            levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token operator">=</span> currentQty  <span class="token comment">' 최상위 레벨 수량 설정</span>
        <span class="token keyword">Else</span>
            levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token operator">=</span> levels<span class="token punctuation">(</span>currentLevel <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> currentQty
        <span class="token keyword">End</span> <span class="token keyword">If</span>

        <span class="token comment">' 계산된 누적 수량을 P 열에 저장</span>
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"P"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span>

NextIteration<span class="token punctuation">:</span>
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="9. 최종 실행 코드" dir="auto" class="heading" id="9._최종_실행_코드_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>9. 최종 실행 코드</h3></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token keyword">Option</span> Explicit

<span class="token comment">' MAIN_SUB 실행 함수입니다.</span>

<span class="token comment">' 최종 수정일:2024-10-22</span>
<span class="token comment">' 버전: 02</span>
<span class="token comment">' 변경내용: 한글 주석 추가, 함수명 변경, 계산 로직 최적화</span>


<span class="token keyword">Public</span> <span class="token keyword">Sub</span> MAIN_EBOM_TO_MBOM_CONVERSION<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ActiveSheet
    
    Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token comment">' 열 삽입 및 헤더 초기화</span>
    <span class="token keyword">Call</span> InsertHeadersAndInitialize<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>

    <span class="token comment">' 열 삽입 및 데이터 복사 작업들</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Level"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Number"</span><span class="token punctuation">,</span> <span class="token string">"M"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">"Product Code"</span><span class="token punctuation">,</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Qty"</span><span class="token punctuation">,</span> <span class="token string">"O"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">"M-BOM.Qty"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.UOM"</span><span class="token punctuation">,</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Buy/Make"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"M-BOM.E/EP/SC"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Description"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Subsidiary Companies Parts"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Mfr. Part Number"</span><span class="token punctuation">,</span> <span class="token string">"V"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Part Type"</span><span class="token punctuation">,</span> <span class="token string">"W"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Mfr. Name"</span><span class="token punctuation">,</span> <span class="token string">"X"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Item Description"</span><span class="token punctuation">,</span> <span class="token string">"Y"</span><span class="token punctuation">)</span>

    <span class="token comment">' Z부터 6개의 빈 열 추가</span>
    <span class="token keyword">Call</span> InsertEmptyColumns<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Z"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Preferred Status"</span><span class="token punctuation">,</span> <span class="token string">"AF"</span><span class="token punctuation">)</span>

    <span class="token comment">' AG부터 DT 열 삭제</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"AG:DT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Clear

    <span class="token comment">' 0 ~ 10 숫자 채우기</span>
    <span class="token keyword">Call</span> FillLevels<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>

    <span class="token comment">' 열 너비 조정</span>
    <span class="token keyword">Call</span> AdjustColumnWidths<span class="token punctuation">(</span>ws<span class="token punctuation">)</span>

    <span class="token comment">' 추가 기능 호출</span>
    <span class="token keyword">Call</span> MBOM_QTY_CAL
    <span class="token keyword">Call</span> MBOM_DIV_FILL
    <span class="token keyword">Call</span> DATA_FORMAT_GENERAL
    
    ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    
    Application<span class="token punctuation">.</span>CutCopyMode <span class="token operator">=</span> <span class="token boolean">False</span>
    Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="완성본:" dir="auto" class="heading" id="완성본_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>완성본:</h2></div><div class="el-pre"><pre class="language-vb" tabindex="0"><code data-line="0" class="language-vb is-loaded"><span class="token keyword">Option</span> Explicit

<span class="token comment">' MAIN_SUB 실행 함수입니다.</span>

<span class="token comment">' 최종 수정일:2024-10-22</span>
<span class="token comment">' 버전: 02</span>
<span class="token comment">' 변경내용: 한글 주석 추가, 함수명 변경, 계산 로직 최적화</span>


<span class="token keyword">Public</span> <span class="token keyword">Sub</span> MAIN_EBOM_TO_MBOM_CONVERSION<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ActiveSheet
    
    Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token comment">' 열 삽입 및 헤더 초기화</span>
    <span class="token keyword">Call</span> InsertHeadersAndInitialize<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>

    <span class="token comment">' 열 삽입 및 데이터 복사 작업들</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Level"</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Number"</span><span class="token punctuation">,</span> <span class="token string">"M"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">"Product Code"</span><span class="token punctuation">,</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Qty"</span><span class="token punctuation">,</span> <span class="token string">"O"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">"M-BOM.Qty"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.UOM"</span><span class="token punctuation">,</span> <span class="token string">"Q"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Buy/Make"</span><span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> AddNewColumn<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">"M-BOM.E/EP/SC"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Description"</span><span class="token punctuation">,</span> <span class="token string">"T"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Subsidiary Companies Parts"</span><span class="token punctuation">,</span> <span class="token string">"U"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Mfr. Part Number"</span><span class="token punctuation">,</span> <span class="token string">"V"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Part Type"</span><span class="token punctuation">,</span> <span class="token string">"W"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Mfr. Name"</span><span class="token punctuation">,</span> <span class="token string">"X"</span><span class="token punctuation">)</span>
    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"BOM.Item Description"</span><span class="token punctuation">,</span> <span class="token string">"Y"</span><span class="token punctuation">)</span>

    <span class="token comment">' Z부터 6개의 빈 열 추가</span>
    <span class="token keyword">Call</span> InsertEmptyColumns<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Z"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">Call</span> HandleColumnCopy<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"Manufacturers.Preferred Status"</span><span class="token punctuation">,</span> <span class="token string">"AF"</span><span class="token punctuation">)</span>

    <span class="token comment">' AG부터 DT 열 삭제</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"AG:DT"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Clear

    <span class="token comment">' 0 ~ 10 숫자 채우기</span>
    <span class="token keyword">Call</span> FillLevels<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>

    <span class="token comment">' 열 너비 조정</span>
    <span class="token keyword">Call</span> AdjustColumnWidths<span class="token punctuation">(</span>ws<span class="token punctuation">)</span>

    <span class="token comment">' 추가 기능 호출</span>
    <span class="token keyword">Call</span> MBOM_QTY_CAL
    <span class="token keyword">Call</span> MBOM_DIV_FILL
    <span class="token keyword">Call</span> DATA_FORMAT_GENERAL
    
    ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    
    Application<span class="token punctuation">.</span>CutCopyMode <span class="token operator">=</span> <span class="token boolean">False</span>
    Application<span class="token punctuation">.</span>ScreenUpdating <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' 열 삽입 및 헤더 초기화</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> InsertHeadersAndInitialize<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> columnCount <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> columnCount
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' 0부터 10까지 Level 값 채우기</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> FillLevels<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> maxCol <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Variant</span>  <span class="token comment">' 각 행의 Level 값</span>
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token comment">' L 열의 마지막 행 찾기</span>
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row

    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> maxCol
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span> i
    
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value  <span class="token comment">' L 열의 Level 값 읽기</span>

        <span class="token comment">' 유효한 Level 값(0 ~ maxCol-1)만 처리</span>
        <span class="token keyword">If</span> IsNumeric<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span> maxCol <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> currentLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> currentLevel  <span class="token comment">' 해당 Level에 맞는 열에 값 입력</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>


<span class="token comment">' 열 삽입 및 복사 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> HandleColumnCopy<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> columnName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> targetCol <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">Optional</span> width <span class="token keyword">As</span> <span class="token keyword">Integer</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> find <span class="token keyword">As</span> Range
    <span class="token keyword">Set</span> find <span class="token operator">=</span> ws<span class="token punctuation">.</span>Rows<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>find<span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> LookIn<span class="token punctuation">:</span><span class="token operator">=</span>xlValues<span class="token punctuation">,</span> LookAt<span class="token punctuation">:</span><span class="token operator">=</span>xlWhole<span class="token punctuation">)</span>

    <span class="token keyword">If</span> <span class="token keyword">Not</span> find <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
        find<span class="token punctuation">.</span>EntireColumn<span class="token punctuation">.</span>Cut destination<span class="token punctuation">:</span><span class="token operator">=</span>ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span>
        Application<span class="token punctuation">.</span>CutCopyMode <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">If</span> width <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span> ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>targetCol<span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> width
    <span class="token keyword">Else</span>
        MsgBox <span class="token string">"Column '"</span> <span class="token operator">&amp;</span> columnName <span class="token operator">&amp;</span> <span class="token string">"' not found!"</span><span class="token punctuation">,</span> vbExclamation<span class="token punctuation">,</span> <span class="token string">"Error"</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' 새로운 열 추가 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> AddNewColumn<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> colNum <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">,</span> header <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> value <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">)</span>

    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> header
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> r <span class="token keyword">As</span> <span class="token keyword">Long</span>
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> colNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    <span class="token keyword">For</span> r <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>r<span class="token punctuation">,</span> colNum<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
    <span class="token keyword">Next</span> r
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' 빈 열 삽입 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> InsertEmptyColumns<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> startCol <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> count <span class="token keyword">As</span> <span class="token keyword">Integer</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> count
        ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span>startCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Insert Shift<span class="token punctuation">:</span><span class="token operator">=</span>xlToRight
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' Level, Qty 등의 열 Data format 표준으로 설정</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> DATA_FORMAT_GENERAL<span class="token punctuation">(</span><span class="token punctuation">)</span>

    columns<span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Selection<span class="token punctuation">.</span>NumberFormatLocal <span class="token operator">=</span> <span class="token string">"G/표준"</span>
    Selection<span class="token punctuation">.</span>value <span class="token operator">=</span> Selection<span class="token punctuation">.</span>value
  
    columns<span class="token punctuation">(</span><span class="token string">"O"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Selection<span class="token punctuation">.</span>NumberFormatLocal <span class="token operator">=</span> <span class="token string">"G/표준"</span>
    Selection<span class="token punctuation">.</span>value <span class="token operator">=</span> Selection<span class="token punctuation">.</span>value
    
    columns<span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Select</span>
    Selection<span class="token punctuation">.</span>NumberFormatLocal <span class="token operator">=</span> <span class="token string">"G/표준"</span>
    Selection<span class="token punctuation">.</span>value <span class="token operator">=</span> Selection<span class="token punctuation">.</span>value
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' 열 너비 조정 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> AdjustColumnWidths<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">)</span>

    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"A:K"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">3</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"M:N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">20</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"U:V"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">25</span>
    ws<span class="token punctuation">.</span>columns<span class="token punctuation">(</span><span class="token string">"X:Y"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ColumnWidth <span class="token operator">=</span> <span class="token number">25</span>
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' E/EP/SC 처리 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> MBOM_DIV_FILL<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> parentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">,</span> parentRow <span class="token keyword">As</span> <span class="token keyword">Long</span>

    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>ActiveSheet
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row

    parentRow <span class="token operator">=</span> FindParentRow<span class="token punctuation">(</span>ws<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">,</span> <span class="token string">"Buy"</span><span class="token punctuation">,</span> parentLevel<span class="token punctuation">)</span>

    <span class="token keyword">If</span> parentRow <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        MsgBox <span class="token string">"""BOM.Buy"" row not found in the specified column."</span>
        <span class="token keyword">Exit</span> <span class="token keyword">Sub</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>

    <span class="token keyword">For</span> i <span class="token operator">=</span> parentRow <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        <span class="token keyword">If</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Buy"</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span><span class="token operator">=</span> parentLevel <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"E"</span>
            parentLevel <span class="token operator">=</span> currentLevel
        <span class="token keyword">ElseIf</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Make"</span> <span class="token keyword">And</span> currentLevel <span class="token operator">&lt;</span><span class="token operator">=</span> parentLevel <span class="token keyword">Then</span>
            parentLevel <span class="token operator">=</span> currentLevel <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token keyword">ElseIf</span> currentLevel <span class="token operator">&gt;</span> parentLevel <span class="token keyword">And</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"R"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"Buy"</span> <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"EP"</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i
    
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token comment">' Parent Row 찾기</span>
<span class="token keyword">Function</span> FindParentRow<span class="token punctuation">(</span>ws <span class="token keyword">As</span> Worksheet<span class="token punctuation">,</span> colName <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> searchValue <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">,</span> <span class="token keyword">ByRef</span> parentLevel <span class="token keyword">As</span> <span class="token keyword">Long</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> colName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
        <span class="token keyword">If</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> colName<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> searchValue <span class="token keyword">Then</span>
            parentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
            FindParentRow <span class="token operator">=</span> i
            <span class="token keyword">Exit</span> <span class="token keyword">Function</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> i
    FindParentRow <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>

<span class="token comment">' MBOM QTY 계산 함수</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> MBOM_QTY_CAL<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">Dim</span> ws <span class="token keyword">As</span> Worksheet
    <span class="token keyword">Dim</span> lastRow <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> levels<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Double</span>  <span class="token comment">' 각 레벨별 누적 수량 저장</span>
    <span class="token keyword">Dim</span> maxLevel <span class="token keyword">As</span> <span class="token keyword">Long</span>
    <span class="token keyword">Dim</span> currentLevel <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">,</span> currentQty <span class="token keyword">As</span> <span class="token keyword">Variant</span>

    <span class="token keyword">Set</span> ws <span class="token operator">=</span> ThisWorkbook<span class="token punctuation">.</span>ActiveSheet
    lastRow <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>ws<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>count<span class="token punctuation">,</span> <span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span>xlUp<span class="token punctuation">)</span><span class="token punctuation">.</span>Row
    maxLevel <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment">' 최대 레벨 설정</span>

    <span class="token comment">' 1부터 시작하는 배열 초기화</span>
    <span class="token keyword">ReDim</span> levels<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> maxLevel<span class="token punctuation">)</span>

    <span class="token comment">' 각 행에 대해 수량 계산 수행</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> lastRow
        currentLevel <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        currentQty <span class="token operator">=</span> ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"O"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value

        <span class="token comment">' 빈 셀, 숫자가 아닌 값, 레벨이 초과된 경우 건너뛰기</span>
        <span class="token keyword">If</span> IsEmpty<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">Or</span> IsEmpty<span class="token punctuation">(</span>currentQty<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">If</span> <span class="token keyword">Not</span> IsNumeric<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token keyword">Or</span> <span class="token keyword">Not</span> IsNumeric<span class="token punctuation">(</span>currentQty<span class="token punctuation">)</span> <span class="token keyword">Then</span> <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">If</span> currentLevel <span class="token operator">&gt;</span> maxLevel <span class="token keyword">Then</span>
            ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"P"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ClearContents  <span class="token comment">' 레벨이 초과되면 P 열을 비움</span>
            <span class="token keyword">GoTo</span> NextIteration
        <span class="token keyword">End</span> <span class="token keyword">If</span>

        <span class="token comment">' 누적 수량 계산: 현재 레벨의 수량에 상위 모든 부모 수량을 곱함</span>
        <span class="token keyword">If</span> currentLevel <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span>
            levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token operator">=</span> currentQty  <span class="token comment">' 최상위 레벨 수량 설정</span>
        <span class="token keyword">Else</span>
            levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span> <span class="token operator">=</span> levels<span class="token punctuation">(</span>currentLevel <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> currentQty
        <span class="token keyword">End</span> <span class="token keyword">If</span>

        <span class="token comment">' 계산된 누적 수량을 P 열에 저장</span>
        ws<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"P"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> levels<span class="token punctuation">(</span>currentLevel<span class="token punctuation">)</span>

NextIteration<span class="token punctuation">:</span>
    <span class="token keyword">Next</span> i

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="결과:" dir="auto" class="heading" id="결과_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>결과:</h2></div><div class="el-p"><p dir="auto">기존에 몇 시간씩 걸리던 작업이 이 모듈을 사용한 이후로는 5분도 걸리지 않았다. 다른 그룹에는 ‘M-BOM 작성만’ 담당하는 직원이 있다고 하는데 뭔가 머리가 띵한 기분이 든다.<br>
처음에 로직 구현에 애를 먹어서 ChatGPT랑 한참 씨름을 하다가 결국엔 직접 구현한 좀 비효율적인 함수로 모듈을 만들었었는데, 이번에 이 글을 작성하면서 리팩토링을 했다.<br>
익숙한 언어가 아니기에 이것저것 수정하고 고민하던 재미도 있었고, 어쨌든 새로운 언어를 배우면서 원하는 결과물을 구현하는, 꽤 재밌는 작업이었던 거 같다.</p></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div class="graph-view-wrapper"><div class="feature-header"><div class="feature-title">Interactive Graph</div></div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<div class="graph-icon graph-global" role="button" aria-label="Global Graph" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-git-fork"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#Excel_VBA_E-BOM_to_M-BOM_자동_변환_모듈_0" data-path="#Excel_VBA_E-BOM_to_M-BOM_자동_변환_모듈_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Excel VBA_E-BOM to M-BOM 자동 변환 모듈">Excel VBA_E-BOM to M-BOM 자동 변환 모듈</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#배경_0" data-path="#배경_0"><div class="tree-item-inner heading-link" heading-name="배경:">배경:</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#필요_기능_정리_0" data-path="#필요_기능_정리_0"><div class="tree-item-inner heading-link" heading-name="필요 기능 정리">필요 기능 정리</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#Code_0" data-path="#Code_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Code:">Code:</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#1._열_삽입_및_헤더_초기화_0" data-path="#1._열_삽입_및_헤더_초기화_0"><div class="tree-item-inner heading-link" heading-name="1. 열 삽입 및 헤더 초기화">1. 열 삽입 및 헤더 초기화</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#2._0~10까지의_Level_값_헤더와_매칭하여_채우기_0" data-path="#2._0~10까지의_Level_값_헤더와_매칭하여_채우기_0"><div class="tree-item-inner heading-link" heading-name="2. 0~10까지의 Level 값 헤더와 매칭하여 채우기">2. 0~10까지의 Level 값 헤더와 매칭하여 채우기</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#3._열_삽입_및_복사_함수_0" data-path="#3._열_삽입_및_복사_함수_0"><div class="tree-item-inner heading-link" heading-name="3. 열 삽입 및 복사 함수">3. 열 삽입 및 복사 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#4._새로운_열_추가_함수_0" data-path="#4._새로운_열_추가_함수_0"><div class="tree-item-inner heading-link" heading-name="4. 새로운 열 추가 함수">4. 새로운 열 추가 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#5._빈_열_삽입_함수_0" data-path="#5._빈_열_삽입_함수_0"><div class="tree-item-inner heading-link" heading-name="5. 빈 열 삽입 함수">5. 빈 열 삽입 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#6._열_너비_조정_함수_0" data-path="#6._열_너비_조정_함수_0"><div class="tree-item-inner heading-link" heading-name="6. 열 너비 조정 함수">6. 열 너비 조정 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#7._E/EP/SC_처리_함수_0" data-path="#7._E/EP/SC_처리_함수_0"><div class="tree-item-inner heading-link" heading-name="7. E/EP/SC 처리 함수">7. E/EP/SC 처리 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#8._M-BOM_Qty_계산_함수_0" data-path="#8._M-BOM_Qty_계산_함수_0"><div class="tree-item-inner heading-link" heading-name="8. M-BOM Qty 계산 함수">8. M-BOM Qty 계산 함수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#9._최종_실행_코드_0" data-path="#9._최종_실행_코드_0"><div class="tree-item-inner heading-link" heading-name="9. 최종 실행 코드">9. 최종 실행 코드</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#완성본_0" data-path="#완성본_0"><div class="tree-item-inner heading-link" heading-name="완성본:">완성본:</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="works/microsoft/excel-vba/excel-vba_e-bom-to-m-bom-자동-변환-모듈.html#결과_0" data-path="#결과_0"><div class="tree-item-inner heading-link" heading-name="결과:">결과:</div></a><div class="tree-item-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></body></html>